drop database if exists test;
create database test;
use test;

CREATE TABLE t (a INT PRIMARY KEY NONCLUSTERED, b INT);

INSERT INTO t VALUES (1, 2);
UPDATE t SET a = 2 WHERE a = 1;

INSERT INTO t VALUES (1, 22);
UPDATE t SET a = 22 WHERE a = 1;

-- b = 222, partition = 2
INSERT INTO t VALUES (1, 222);
UPDATE t SET a = 222 WHERE a = 1;


INSERT INTO t VALUES (1, 3);
UPDATE t SET a=3 WHERE a=1;


INSERT INTO t VALUES (1, 33);
UPDATE t SET a=33 WHERE a=1;

-- b = 333333, partition = 1
INSERT INTO t VALUES (1, 333333);
UPDATE t SET a=333 WHERE a=1;


INSERT INTO t VALUES (1, 6);
UPDATE t SET a=6 WHERE a=1;


INSERT INTO t VALUES (1, 66);
UPDATE t SET a=66 WHERE a=1;

-- b = 333333, partition = 1
INSERT INTO t VALUES (1, 666);
UPDATE t SET a=666 WHERE a=1;


INSERT INTO t VALUES (1, 7);
UPDATE t SET a=7 WHERE a=1;


INSERT INTO t VALUES (1, 77);
UPDATE t SET a=77 WHERE a=1;

-- b = 333333, partition = 1
INSERT INTO t VALUES (1, 777);
UPDATE t SET a=777 WHERE a=1;


INSERT INTO t VALUES (1, 8);
UPDATE t SET a=8 WHERE a=1;


INSERT INTO t VALUES (1, 88);
UPDATE t SET a=88 WHERE a=1;

-- b = 333333, partition = 1
INSERT INTO t VALUES (1, 888);
UPDATE t SET a=888 WHERE a=1;


INSERT INTO t VALUES (1, 9);
UPDATE t SET a=9 WHERE a=1;


INSERT INTO t VALUES (1, 99);
UPDATE t SET a=99 WHERE a=1;

-- b = 333333, partition = 1
INSERT INTO t VALUES (1, 999);
UPDATE t SET a=999 WHERE a=1;

CREATE TABLE test.finish_mark (a int primary key);